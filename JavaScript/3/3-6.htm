<html>

<head>
<title>在按钮上定时显示不同的链接</title>
</head>

<SCRIPT LANGUAGE="JavaScript">
var startTime   =null;
var timerID     =null;
var initial     =new Date();
var pos         =0;
var menuItem    =null;
function initArray() {<!--矩阵生成函数-->
 this.length = initArray.arguments.length
   for (var i = 0; i < this.length; i++)      {
    this[i+1] = initArray.arguments[i]<!--根据输入的字符串，构造一个矩阵-->
   }
}

function parsemenuItem(data,num) {<!--将数组中每一项中的内容和url分开-->
 for(var i=0;i<data.length;i++)  {
  if(data.substring(i,i+1)=="|")  break;<!--找到分隔符-->
   }
   if (num==0) return(data.substring(0,i));
   else  return(data.substring(i+1,data.length));
}
function startTimer() {
   initial = new Date();<!--获得当前日期-->
   startTime=initial.getTime();
   stopTimer();<!--清除目前的定时器-->
    menuItem = new initArray(
    "南京大学|#",
     "北京大学|#",
      "清华大学|#",
      "复旦大学|#",
      "浙江大学|#"
 
   );<!--调用初始化数组函数-->
   showTimer();<!--调用shoutimer函数-->
}


function stopTimer() {<!--定时停止函数-->
   timerID=null;<!--清空定时器-->
   menuItem=null;<!--清空定时器-->
}

function showTimer() {<!--循环显示按钮内容的函数-->
 pos= (pos == menuItem.length) ? 1 : pos + 1;<!--更新pos的值-->
 document.forms[0].elements[0].value=parsemenuItem(menuItem[pos],0);<!--更新显示的链接-->

   timerID=window.setTimeout('showTimer()',1000);<!--每1秒调用依次showtimer函数-->
}

function goToUrl()  {
   this.location=parsemenuItem(menuItem[pos],1);<!--获取当前显示对应的链接，并返回-->
   return (false);
}

</SCRIPT>

<body background="06.jpg" onLoad="window.startTimer()">
<FORM>
<p align="center">
<INPUT TYPE="button" VALUE="  WHERE TO? "  NAME="goTo"
        onClick="window.goToUrl()">
</FORM>
</body>

</html>
<!--本例程实现了在按钮上定时显示不同的链接的功能-->
<!--按钮控件的使用-->
<!--数组、字符串相关方法的使用-->
<!--定时器的使用-->